{% extends "base.html" %}
{% block title %}پلن‌های VPN{% endblock %}
{% block header_title %}پلن‌های VPN{% endblock %}
{% block nav_home_active %}active{% endblock %}

{% block content %}
<div class="tg-section tg-fade-in">
    <p class="tg-text-muted text-center mb-4">لطفاً یکی از پلن‌های زیر را انتخاب کنید</p>

    {% for plan in plans %}
    <div class="tg-card plan-card mb-3 ripple" onclick="location.href='{% url 'shop:purchase_create' plan.id %}'">
        <div class="d-flex align-items-center p-3">
            <div class="plan-icon me-3">
                <i class="fas fa-shield-alt"></i>
            </div>
            <div class="plan-details flex-grow-1">
                <h3 class="plan-name mb-1">{{ plan.name }}</h3>
                <div class="d-flex align-items-center justify-content-between">
                    <div class="plan-duration tg-text-muted">
                        <i class="fas fa-calendar-alt me-1"></i> {{ plan.duration }} روز
                    </div>
                    <div class="plan-price">
                        <span class="price-amount">{{ plan.price|floatformat:"0" }}</span>
                        <span class="price-currency tg-text-muted">تومان</span>
                    </div>
                </div>
            </div>
            <div class="plan-arrow">
                <i class="fas fa-chevron-left tg-text-muted"></i>
            </div>
        </div>
        {% if plan.description %}
        <div class="plan-description px-3 pb-3 pt-0">
            <div class="tg-text-muted small">{{ plan.description|linebreaksbr }}</div>
        </div>
        {% endif %}

        {% if forloop.first %}
        <div class="plan-badge">پیشنهاد ویژه</div>
        {% endif %}
    </div>
    {% empty %}
    <div class="tg-card text-center p-4">
        <i class="fas fa-exclamation-circle fa-3x tg-text-muted mb-3"></i>
        <p>در حال حاضر هیچ پلنی موجود نیست.</p>
    </div>
    {% endfor %}
</div>

<div class="tg-section mt-4">
    <h3 class="tg-section-title">سوالات متداول</h3>

    <div class="tg-card faq-card">
        <div class="faq-item p-3" onclick="toggleFaq(this)">
            <div class="d-flex justify-content-between align-items-center">
                <div class="faq-question">بعد از خرید چقدر طول می‌کشد تا سرویس فعال شود؟</div>
                <i class="fas fa-chevron-down tg-text-muted faq-toggle"></i>
            </div>
            <div class="faq-answer mt-2" style="display: none;">
                معمولاً بعد از تأیید پرداخت، سرویس شما در کمتر از 15 دقیقه فعال می‌شود.
            </div>
        </div>

        <div class="faq-item p-3" onclick="toggleFaq(this)">
            <div class="d-flex justify-content-between align-items-center">
                <div class="faq-question">آیا امکان تمدید سرویس وجود دارد؟</div>
                <i class="fas fa-chevron-down tg-text-muted faq-toggle"></i>
            </div>
            <div class="faq-answer mt-2" style="display: none;">
                بله، می‌توانید قبل از اتمام اعتبار، سرویس خود را تمدید کنید.
            </div>
        </div>

        <div class="faq-item p-3" onclick="toggleFaq(this)">
            <div class="d-flex justify-content-between align-items-center">
                <div class="faq-question">چگونه از کانفیگ VPN استفاده کنم؟</div>
                <i class="fas fa-chevron-down tg-text-muted faq-toggle"></i>
            </div>
            <div class="faq-answer mt-2" style="display: none;">
                پس از خرید و تأیید پرداخت، کانفیگ VPN برای شما فعال می‌شود. کافیست آن را کپی کرده و در نرم‌افزار مورد نظر خود وارد کنید.
            </div>
        </div>
    </div>
</div>

<style>
    .plan-card {
        position: relative;
        transition: transform 0.2s;
    }

    .plan-card:active {
        transform: scale(0.98);
    }

    .plan-icon {
        width: 40px;
        height: 40px;
        background-color: var(--tg-theme-button-color);
        color: white;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
    }

    .plan-name {
        font-size: 16px;
        font-weight: 600;
    }

    .plan-duration {
        font-size: 14px;
    }

    .price-amount {
        font-size: 16px;
        font-weight: 700;
        color: var(--tg-theme-button-color);
    }

    .price-currency {
        font-size: 12px;
    }

    .plan-badge {
        position: absolute;
        top: 0;
        right: 0;
        background-color: #ff3b30;
        color: white;
        font-size: 12px;
        font-weight: 500;
        padding: 4px 8px;
        border-radius: 0 var(--tg-border-radius) 0 8px;
    }

    .faq-item {
        border-bottom: 1px solid rgba(0,0,0,0.05);
        cursor: pointer;
    }

    body.dark .faq-item {
        border-bottom: 1px solid rgba(255,255,255,0.05);
    }

    .faq-item:last-child {
        border-bottom: none;
    }

    .faq-question {
        font-weight: 500;
    }

    .faq-answer {
        font-size: 14px;
        color: var(--tg-theme-hint-color);
    }

    .faq-toggle {
        transition: transform 0.3s;
    }

    .faq-item.active .faq-toggle {
        transform: rotate(180deg);
    }
</style>

<script>
    function toggleFaq(element) {
        const answer = element.querySelector('.faq-answer');
        const isActive = element.classList.contains('active');

        if (isActive) {
            element.classList.remove('active');
            answer.style.display = 'none';
        } else {
            element.classList.add('active');
            answer.style.display = 'block';
        }
    }
</script>
{% endblock %}